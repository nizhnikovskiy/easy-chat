import{r as i,j as e}from"./index-xl9o6DcG.js";import{M as ae}from"./MessageContextMenu-DsRTQY6S.js";import{f as re}from"./formatText-C7nXlOGZ.js";const le=({content:g,sender:w,showAvatar:f=!0,avatarSrc:C,avatarBgColor:D="bg-gray-400",showUsername:F=!1,username:d,showTimestamp:b=!1,timestamp:m,className:S="",groupPosition:l,showReadStatus:k=!1,isRead:x=!1,disableTextCopy:L=!1,"aria-label":T,messageId:q,contextMenuItems:r,isLoading:G=!1,isTyping:H=!1,theme:s="light",sentIcon:M,readIcon:E})=>{var X;const[O,p]=i.useState(!1),[J,B]=i.useState({x:0,y:0}),n=i.useRef(null),[h,j]=i.useState(null),[v,$]=i.useState(null),t=w==="user",U=!l||l==="standalone"||l==="last",K=!l||l==="standalone"||l==="first",N=f&&U,R=F&&K,P=U,Q=t?s==="dark"?"bg-message-user-bg-dark text-message-user-text-dark":"bg-message-user-bg text-message-user-text":s==="dark"?"bg-message-other-bg-dark text-message-other-text-dark":"bg-message-other-bg text-message-other-text",W=P?t?"rounded-br-none":"rounded-bl-none":"",Y=t?"justify-end":"justify-start",z=t?"flex-row-reverse":"flex-row",A=l==="first"||l==="middle"?"mb-1":"mb-4",u=["50%","65%","80%","70%","90%"],V=u[Math.floor(Math.random()*u.length)],Z=u[Math.floor(Math.random()*u.length)],_=N&&e.jsx("div",{className:`shrink-0 w-10 h-10 rounded-full ${D} flex items-center justify-center text-avatar-text font-semibold overflow-hidden`,"aria-hidden":"true",children:C?e.jsx("img",{src:C,alt:d||(t?"User":"Other"),className:"w-full h-full object-cover"}):e.jsx("span",{children:(d||(t?"You":"Other")).charAt(0).toUpperCase()})});if(G){const o=t?s==="dark"?"bg-message-user-bg-dark":"bg-message-user-bg":s==="dark"?"bg-skeleton-bg-dark":"bg-skeleton-bg",a=s==="dark"?"bg-skeleton-shimmer-dark":"bg-skeleton-shimmer";return e.jsx("article",{className:`flex ${Y} ${A} ${S} animate-pulse`,"aria-label":T||`Loading message from ${t?"you":d||"other"}`,children:e.jsxs("div",{className:`flex ${z} items-end gap-2 max-w-[80%] md:max-w-[70%]`,children:[N?e.jsx("div",{className:`shrink-0 w-10 h-10 rounded-full ${a}`}):f&&e.jsx("div",{className:"shrink-0 w-10","aria-hidden":"true"}),e.jsxs("div",{className:"flex flex-col gap-1 min-w-0",children:[R&&e.jsx("div",{className:`h-3 w-16 ${a} rounded ${t?"ml-auto":""}`}),e.jsx("div",{className:`w-64 px-4 py-2 rounded-2xl ${o} ${W}`,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`h-4 ${s==="dark"?"bg-skeleton-shimmer-dark":"bg-skeleton-shimmer"} opacity-50 rounded`,style:{width:V}}),e.jsx("div",{className:`h-4 ${s==="dark"?"bg-skeleton-shimmer-dark":"bg-skeleton-shimmer"} opacity-50 rounded`,style:{width:Z}})]})})]})]})})}const I=o=>{if(r&&r.length>0&&n.current){o.preventDefault();const a=n.current.getBoundingClientRect();B({x:a.left+a.width/2,y:a.bottom}),p(!0)}},ee=o=>{if(!r||r.length===0||!n.current)return;const a=o.touches[0];$({x:a.clientX,y:a.clientY});const y=setTimeout(()=>{if(n.current){const c=n.current.getBoundingClientRect();B({x:c.left+c.width/2,y:c.bottom}),p(!0)}},500);j(y)},se=o=>{if(!v||!h)return;const a=o.touches[0],y=Math.abs(a.clientX-v.x),c=Math.abs(a.clientY-v.y);(y>10||c>10)&&(clearTimeout(h),j(null),$(null))},te=()=>{h&&(clearTimeout(h),j(null)),$(null)};return e.jsxs(e.Fragment,{children:[e.jsx("article",{className:`flex ${Y} ${A} ${S} ${O?"relative z-9999":""}`,"aria-label":T||`Message from ${t?"you":d||"other"}`,children:e.jsxs("div",{className:`flex ${z} items-end gap-2 max-w-[80%] md:max-w-[70%]`,children:[N?_:f&&e.jsx("div",{className:"shrink-0 w-10","aria-hidden":"true"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[R&&d&&e.jsx("div",{className:`text-xs ${s==="dark"?"text-username-text-dark":"text-username-text"} px-2 ${t?"text-right":"text-left"}`,"aria-label":"Sender name",children:d}),e.jsxs("div",{ref:n,onContextMenu:I,onTouchStart:ee,onTouchMove:se,onTouchEnd:te,className:`
                relative px-4 py-2 rounded-2xl shadow-sm
                ${Q} 
                ${W}
                ${b||k?"pb-5":""}
                ${r&&r.length>0||L?"select-none":""}
                ${H?"w-64":""}
              `,style:r&&r.length>0?{WebkitUserSelect:"none",touchAction:"manipulation"}:void 0,children:[e.jsx("div",{className:"text-sm md:text-base leading-relaxed break-words",children:typeof g=="string"?re(g):g}),(b||k)&&e.jsxs("div",{className:`
                    absolute bottom-1 right-2 flex items-center gap-1
                  `,children:[b&&m&&e.jsx("time",{className:`text-xs ${t?s==="dark"?"text-message-user-timestamp-dark":"text-message-user-timestamp":s==="dark"?"text-message-other-timestamp-dark":"text-message-other-timestamp"}`,dateTime:m,"aria-label":`Sent at ${m}`,children:m}),k&&e.jsx("div",{className:"flex items-center","aria-label":x?"Read":"Sent",title:x?"Read":"Sent",children:x&&E?i.cloneElement(E,{className:t?s==="dark"?"text-message-user-timestamp-dark":"text-message-user-timestamp":s==="dark"?"text-message-other-timestamp-dark":"text-message-other-timestamp",size:16}):!x&&M?i.cloneElement(M,{className:t?s==="dark"?"text-message-user-timestamp-dark":"text-message-user-timestamp":s==="dark"?"text-message-other-timestamp-dark":"text-message-other-timestamp",size:16}):null})]})]})]})]})}),r&&r.length>0&&e.jsx(ae,{isOpen:O,position:J,items:r,onClose:()=>p(!1),messageId:q,bubbleRect:((X=n.current)==null?void 0:X.getBoundingClientRect())||null,sender:w,theme:s})]})};le.displayName="Message";export{le as M};

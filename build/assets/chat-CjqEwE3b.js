import{j as a,r as n}from"./index-xl9o6DcG.js";import{C as Y}from"./ChatInput-FGo2StRi.js";import{M as w}from"./Message-CGUyE88l.js";import{T as Z}from"./TypingMessage-C2Ccl2vn.js";const _=({date:r,theme:c="light"})=>a.jsx("div",{className:"flex justify-center items-center my-4",children:a.jsx("div",{className:`${c==="dark"?"bg-separator-bg-dark text-separator-text-dark":"bg-separator-bg text-separator-text"} text-xs px-3 py-1.5 rounded-full shadow-sm`,children:r})}),D=()=>{const[r]=n.useState(!1);return{isReflectionFinished:r}},oe=({messages:r,isPending:c,onSendMessage:N,messagesEndRef:y,isHistoryCompleted:T=!1,backgroundImage:j,backgroundImageDark:u,contextMenuConfig:l,onEditMessage:p,onDeleteMessage:h,containerClassName:U="",theme:d="light",sendIcon:A,attachmentIcon:B,microphoneIcon:E,closeIcon:R,copyIcon:k,editIcon:$,deleteIcon:F,sentIcon:L,readIcon:z})=>{D();const[x,g]=n.useState(""),[C,G]=n.useState(!1),[H,b]=n.useState(null),[S,P]=n.useState(0),V=e=>{const s=[{id:"copy",label:"Copy",icon:k,onClick:t=>{const i=parseInt((t==null?void 0:t.replace("msg-",""))||"0"),o=r[i];o&&"content"in o&&navigator.clipboard.writeText(o.content)}}];return e&&(s.push({id:"edit",label:"Edit",icon:$,onClick:t=>{if(p&&t){const i=parseInt(t.replace("msg-","")),o=r[i];if(o&&"content"in o){const m=prompt("Edit message:",o.content);m!==null&&p(t,m)}}},disabled:!p}),s.push({id:"delete",label:"Delete",icon:F,onClick:t=>{h&&t&&confirm("Are you sure you want to delete this message?")&&h(t)},disabled:!h,divider:!0})),s};n.useEffect(()=>{P(r.length)},[]);const W=e=>{if(e!==r.length-1||e<S)return!1;const s=r[e];if("type"in s&&s.type==="date")return!1;const t=s;return t.role!=="user"&&!t.isTypingComplete},q=j||u?{backgroundImage:`url("${d==="dark"&&u?u:j}")`,backgroundRepeat:"repeat",width:"100%",height:"100%",backgroundSize:"cover"}:{},J=e=>{b(e)},K=(e,s,t)=>{const i=e!==void 0?e:x,o=s!==void 0?s:H;!i.trim()&&!o||(N(i.trim(),o||void 0,t),g(""),b(null),G(!0))},O=()=>{setTimeout(()=>{var e;(e=y.current)==null||e.scrollIntoView({behavior:"smooth"})},100)};return a.jsx("div",{className:"h-full w-full overflow-hidden",children:a.jsxs("div",{className:"h-[calc(100vh-5rem)] flex flex-col",style:q,children:[a.jsxs("div",{className:`flex-1 overflow-y-auto overflow-x-hidden w-full max-w-250 p-4 mx-auto ${U}`,children:[a.jsxs("div",{style:{paddingBottom:"1rem"},children:[r.map((e,s)=>{if("type"in e&&e.type==="date")return a.jsx(_,{date:e.date,theme:d},`date-${s}`);const t=e,i=t.role==="user",o=i?"user":"other",m=W(s),Q=s>=S?i?"animate-slide-in-right":"animate-slide-in-left":"",X=`msg-${s}`;let f;if((l==null?void 0:l.enabled)!==!1)if(l!=null&&l.items)f=l.items;else{const I=V(i);f=l!=null&&l.customItems?[...I,...l.customItems]:I}const v={sender:o,showAvatar:!0,showUsername:!1,showTimestamp:!1,groupPosition:"standalone",className:Q,messageId:X,contextMenuItems:f,theme:d,sentIcon:L,readIcon:z};return t.image?a.jsx(w,{...v,content:a.jsxs(a.Fragment,{children:[a.jsx("img",{src:t.image,alt:"Uploaded",style:{maxWidth:"100%",borderRadius:"0.5rem",marginBottom:"0.5rem"}}),a.jsx("div",{children:t.content})]})},s):m?a.jsx(Z,{...v,text:t.content,typingSpeed:15,onComplete:O},s):a.jsx(w,{...v,content:t.content},s)}),c&&a.jsx(w,{sender:"other",showAvatar:!0,showUsername:!1,showTimestamp:!1,groupPosition:"standalone",content:a.jsx("span",{style:{animation:"pulse 1.5s ease-in-out infinite"},children:"..."}),theme:d})]}),a.jsx("div",{ref:y})]}),!T&&a.jsx("div",{className:"w-full",children:a.jsx(Y,{value:x,onChange:e=>g(e),onSend:(e,s)=>K(e,s),disabled:c,isLoading:c,enableMediaUpload:!0,mediaButton:{accept:"image/*",onUpload:J,icon:B},sendButton:{icon:A},voiceButton:{icon:E},closeIcon:R,placeholder:"Enter message...",autoFocus:C,autoGrow:!0,maxRows:10,className:"bg-transparent px-40",theme:d})})]})})};var M=(r=>(r.USER="user",r.ASSISTANT="assistant",r.TEACHER="teacher",r))(M||{});export{oe as C,M};

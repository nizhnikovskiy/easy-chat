import{r as i,j as e}from"./index-xl9o6DcG.js";import{M as V}from"./MessageContextMenu-DsRTQY6S.js";const Z=({content:A,showAvatar:h=!0,avatarSrc:N,avatarBgColor:O="bg-gray-400",showUsername:X=!1,username:n,showTimestamp:k=!1,timestamp:o,className:v="",groupPosition:l,showReadStatus:w=!1,isRead:c=!1,disableTextCopy:Y=!1,"aria-label":y,messageId:$,contextMenuItems:r,actions:d=[],isLoading:W=!1,theme:a="light",sentIcon:M,readIcon:S})=>{const[z,u]=i.useState(!1),[F,T]=i.useState({x:0,y:0}),[m,f]=i.useState(null),[g,j]=i.useState(null),L=!l||l==="standalone"||l==="last",U=!l||l==="standalone"||l==="first",b=h&&L,C=X&&U,E=l==="first"||l==="middle"?"mb-1":"mb-4",x=["50%","65%","80%","70%","90%"],B=x[Math.floor(Math.random()*x.length)],D=x[Math.floor(Math.random()*x.length)],q=b&&e.jsx("div",{className:`shrink-0 w-10 h-10 rounded-full ${O} flex items-center justify-center text-white font-semibold overflow-hidden`,"aria-hidden":"true",children:N?e.jsx("img",{src:N,alt:n||"Assistant",className:"w-full h-full object-cover"}):e.jsx("span",{children:(n||"AI").charAt(0).toUpperCase()})});if(W){const s=a==="dark"?"bg-skeleton-bg-dark":"bg-skeleton-bg",t=a==="dark"?"bg-skeleton-shimmer-dark":"bg-skeleton-shimmer";return e.jsx("article",{className:`flex justify-start ${E} ${v} animate-pulse`,"aria-label":y||`Loading message from ${n||"assistant"}`,children:e.jsxs("div",{className:"flex flex-row items-start gap-2 max-w-[80%] md:max-w-[70%]",children:[b?e.jsx("div",{className:`shrink-0 w-10 h-10 rounded-full ${s}`}):h&&e.jsx("div",{className:"shrink-0 w-10","aria-hidden":"true"}),e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[C&&e.jsx("div",{className:`h-3 w-16 ${s} rounded`}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`h-4 ${t} opacity-50 rounded`,style:{width:B}}),e.jsx("div",{className:`h-4 ${t} opacity-50 rounded`,style:{width:D}})]}),d&&d.length>0&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("div",{className:`h-6 w-16 ${t} opacity-50 rounded`}),e.jsx("div",{className:`h-6 w-16 ${t} opacity-50 rounded`}),e.jsx("div",{className:`h-6 w-16 ${t} opacity-50 rounded`})]})]})]})})}const G=s=>{r&&r.length>0&&(s.preventDefault(),T({x:s.clientX,y:s.clientY}),u(!0))},H=s=>{if(!r||r.length===0)return;const t=s.touches[0];j({x:t.clientX,y:t.clientY});const p=setTimeout(()=>{T({x:t.clientX,y:t.clientY}),u(!0)},500);f(p)},J=s=>{if(!g||!m)return;const t=s.touches[0],p=Math.abs(t.clientX-g.x),Q=Math.abs(t.clientY-g.y);(p>10||Q>10)&&(clearTimeout(m),f(null),j(null))},K=()=>{m&&(clearTimeout(m),f(null)),j(null)};return e.jsxs(e.Fragment,{children:[e.jsx("article",{className:`flex justify-start ${E} ${v}`,"aria-label":y||`Message from ${n||"assistant"}`,children:e.jsxs("div",{className:"flex flex-row items-start gap-2 max-w-[80%] md:max-w-[70%]",children:[b?q:h&&e.jsx("div",{className:"shrink-0 w-10","aria-hidden":"true"}),e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[C&&n&&e.jsx("div",{className:`text-xs ${a==="dark"?"text-username-text-dark":"text-username-text"} px-0`,"aria-label":"Sender name",children:n}),e.jsxs("div",{onContextMenu:G,onTouchStart:H,onTouchMove:J,onTouchEnd:K,className:"relative",children:[e.jsx("div",{className:["text-sm md:text-base leading-relaxed break-words",a==="dark"?"text-message-other-text-dark":"text-message-other-text",Y?"select-none":""].join(" "),children:A}),(k||w)&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[k&&o&&e.jsx("time",{className:`text-xs ${a==="dark"?"text-message-other-timestamp-dark":"text-message-other-timestamp"}`,dateTime:o,"aria-label":`Sent at ${o}`,children:o}),w&&e.jsx("div",{className:"flex items-center","aria-label":c?"Read":"Sent",title:c?"Read":"Sent",children:c&&S?i.cloneElement(S,{className:a==="dark"?"text-message-other-timestamp-dark":"text-message-other-timestamp",size:16}):!c&&M?i.cloneElement(M,{className:a==="dark"?"text-message-other-timestamp-dark":"text-message-other-timestamp",size:16}):null})]})]}),d&&d.length>0&&e.jsx("div",{className:"flex items-center gap-1 mt-1 flex-wrap",role:"toolbar","aria-label":"Message actions",children:d.map(s=>e.jsxs("button",{onClick:()=>s.onClick($),disabled:s.disabled,className:`
                      flex items-center gap-1 px-2 py-1 rounded text-xs
                      ${a==="dark"?"text-message-other-timestamp-dark hover:bg-menu-hover-bg-dark":"text-message-other-timestamp hover:bg-menu-hover-bg"} 
                      disabled:opacity-50 disabled:cursor-not-allowed
                      transition-colors duration-150
                      ${s.className||""}
                    `,"aria-label":s.label,title:s.label,children:[s.icon&&e.jsx("span",{className:"flex items-center",children:s.icon}),s.label&&e.jsx("span",{children:s.label})]},s.id))})]})]})}),r&&r.length>0&&e.jsx(V,{isOpen:z,position:F,items:r,onClose:()=>u(!1),messageId:$,theme:a})]})};Z.displayName="AssistantMessage";export{Z as A};

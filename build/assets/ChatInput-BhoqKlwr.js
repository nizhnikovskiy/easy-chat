import{j as s,r as n}from"./index-BEcDo9m9.js";import{G as M}from"./iconBase-B9aumZUR.js";function le(l){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"m112 244 144-144 144 144M256 120v292"},child:[]}]})(l)}function te(l){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M216.08 192v143.85a40.08 40.08 0 0 0 80.15 0l.13-188.55a67.94 67.94 0 1 0-135.87 0v189.82a95.51 95.51 0 1 0 191 0V159.74"},child:[]}]})(l)}function ie(l){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(l)}function ce(l){return M({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M192 448h128m64-240v32c0 70.4-57.6 128-128 128h0c-70.4 0-128-57.6-128-128v-32m128 160v80"},child:[]},{tag:"path",attr:{d:"M256 320a78.83 78.83 0 0 1-56.55-24.1A80.89 80.89 0 0 1 176 239V128a79.69 79.69 0 0 1 80-80c44.86 0 80 35.14 80 80v111c0 44.66-35.89 81-80 81z"},child:[]}]})(l)}const ne=({size:l=24,className:c,...d})=>s.jsx(le,{size:l,className:c,...d}),de=({size:l=24,className:c,...d})=>s.jsx(ce,{size:l,className:c,...d}),he=({size:l=24,className:c,...d})=>s.jsx(te,{size:l,className:c,...d}),oe=({size:l=20,className:c,...d})=>s.jsx(ie,{size:l,className:c,...d}),be=({value:l="",onChange:c,onSend:d,placeholder:P="Type a message...",disabled:g=!1,isLoading:x=!1,maxLength:y,showCharacterCount:X=!1,enableMediaUpload:K=!1,mediaButton:a,enableVoiceInput:k=!1,voiceButton:e,sendButton:i,className:Y="",inputClassName:q="",autoFocus:G=!1,autoGrow:N=!0,maxRows:S=10,error:w=!1,errorMessage:j,ariaLabel:J="Message input",sendAriaLabel:L="Send message",mediaAriaLabel:U="Attach media",voiceAriaLabel:O="Record voice message"})=>{const[h,I]=n.useState(l),[b,$]=n.useState(null),[W,z]=n.useState(null),[Q,C]=n.useState(""),[A,V]=n.useState([]),[D,Z]=n.useState(!1),o=n.useRef(null),u=n.useRef(null),E=n.useRef(null),H=n.useRef(`chat-input-error-${Math.random().toString(36).substr(2,9)}`);n.useEffect(()=>{I(l)},[l]),n.useEffect(()=>{if(o.current){N&&(o.current.style.height="auto");const r=o.current.scrollHeight,t=r>52;if(t!==D&&Z(t),N){const f=24*S,m=`${Math.min(r,f)}px`;o.current.style.height=m}}},[h,N,S,D]);const _=r=>{const t=r.target.value;y&&t.length>y||(I(t),c==null||c(t))},v=()=>{var t;if(g||x)return;const r=h.trim();!r&&!b||(d==null||d(r,b||void 0),C("Message sent"),setTimeout(()=>C(""),1e3),I(""),$(null),z(null),c==null||c(""),o.current&&(o.current.style.height="auto"),(t=o.current)==null||t.focus())},B=r=>{r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&(r.preventDefault(),v())},ee=r=>{var p,f;const t=(p=r.target.files)==null?void 0:p[0];if(t){if($(t),(f=a==null?void 0:a.onUpload)==null||f.call(a,t),t.type.startsWith("image/")){const m=new FileReader;m.onload=F=>{var R;return z((R=F.target)==null?void 0:R.result)},m.readAsDataURL(t)}u.current&&(u.current.value="")}},re=()=>{$(null),z(null)},se=r=>{if(!E.current)return;const p=E.current.getBoundingClientRect(),f=Math.max(p.width,p.height),m=r.clientX-p.left-f/2,F=r.clientY-p.top-f/2,R={x:m,y:F,size:f,id:Date.now()};V(ae=>[...ae,R])};n.useEffect(()=>{if(A.length===0)return;const r=setTimeout(()=>{V(t=>t.slice(1))},600);return()=>clearTimeout(r)},[A]);const T=g||x||!h.trim()&&!b;return s.jsxs("div",{className:`flex flex-col gap-2 w-full max-w-250 mx-auto p-4 bg-gray-50 ${Y}`,role:"form","aria-label":"Message input form",children:[s.jsx("div",{role:"status","aria-live":"polite","aria-atomic":"true",className:"sr-only",children:Q}),w&&j&&s.jsx("div",{id:H.current,role:"alert","aria-live":"assertive",className:"text-xs text-red-600 px-2 mb-1",children:j}),b&&W&&s.jsxs("div",{className:"relative inline-block mb-2",children:[s.jsx("img",{src:W,alt:"Selected media preview",className:"w-16 h-16 sm:w-20 sm:h-20 object-cover rounded-lg border border-gray-200"}),s.jsx("button",{onClick:re,className:"absolute -top-2 -right-2 min-w-[28px] min-h-[28px] w-7 h-7 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors",type:"button","aria-label":"Remove media attachment",children:s.jsx(oe,{size:14})})]}),s.jsxs("div",{className:`relative flex items-end bg-white rounded-3xl border border-gray-200/50 hover:border-gray-300/70 focus-within:border-gray-400 transition-all ${D?"pb-13":""}`,children:[K&&s.jsxs(s.Fragment,{children:[s.jsx("input",{ref:u,type:"file",accept:(a==null?void 0:a.accept)||"image/*",onChange:ee,className:"hidden",disabled:g||x||(a==null?void 0:a.disabled),"aria-label":U,id:"media-upload-input"}),(a==null?void 0:a.component)||s.jsx("button",{onClick:()=>{var r;return(r=u.current)==null?void 0:r.click()},disabled:g||x||(a==null?void 0:a.disabled),className:`absolute left-2 bottom-1.5 p-2 text-gray-500 rounded-full transition-all disabled:opacity-50 disabled:cursor-not-allowed border border-gray-200 hover:border-transparent hover:text-gray-700 hover:bg-gray-100 ${(a==null?void 0:a.className)||""}`,type:"button","aria-label":U,"aria-describedby":w&&j?H.current:void 0,children:s.jsx(he,{size:20})})]}),s.jsx("textarea",{ref:o,value:h,onChange:_,onKeyDown:B,placeholder:P,disabled:g||x,autoFocus:G,rows:1,className:`block w-full px-4 py-3 bg-transparent border-0 resize-none focus:outline-none text-gray-900 placeholder:text-gray-400 disabled:text-gray-500 text-base min-h-11 ${K?"pl-14":""} ${!k||h.trim()||b?"pr-14":"pr-4"} ${q}`,style:{maxHeight:`${24*S}px`},"aria-label":J,"aria-invalid":w,"aria-describedby":w&&j?H.current:void 0,"aria-multiline":"true"}),X&&y&&s.jsxs("span",{className:"absolute right-14 bottom-3 text-xs text-gray-400 pointer-events-none","aria-live":"polite","aria-atomic":"true",children:[h.length,"/",y]}),k&&!h.trim()&&!b&&s.jsx(s.Fragment,{children:(e==null?void 0:e.component)||s.jsx("button",{onMouseDown:e==null?void 0:e.onStartRecording,onMouseUp:e==null?void 0:e.onStopRecording,onMouseLeave:e==null?void 0:e.onStopRecording,onTouchStart:e==null?void 0:e.onStartRecording,onTouchEnd:e==null?void 0:e.onStopRecording,disabled:g||x||(e==null?void 0:e.disabled),className:`absolute right-2 bottom-1/2 translate-y-1/2 p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full select-none transition-all border border-gray-200 disabled:cursor-not-allowed ${(e==null?void 0:e.className)||""}`,type:"button","aria-label":e!=null&&e.isRecording?"Recording voice message, release to stop":O,"aria-pressed":e==null?void 0:e.isRecording,children:s.jsx(de,{size:20})})}),(!k||h.trim()||b)&&s.jsx(s.Fragment,{children:(i==null?void 0:i.component)||s.jsxs("button",{ref:E,onClick:r=>{se(r),((i==null?void 0:i.onClick)||v)()},disabled:(i==null?void 0:i.disabled)!==void 0?i.disabled:T,className:`absolute right-2 bottom-1.5 p-2 rounded-full transition-all disabled:cursor-not-allowed overflow-hidden border ${T?"bg-transparent text-gray-400 border-gray-200":"bg-black text-white hover:bg-gray-800 active:scale-95 border-transparent"} ${(i==null?void 0:i.className)||""}`,type:"button","aria-label":L,"aria-disabled":(i==null?void 0:i.disabled)!==void 0?i.disabled:T,children:[A.map(r=>s.jsx("span",{className:"absolute rounded-full bg-white opacity-30 animate-ripple pointer-events-none",style:{left:r.x,top:r.y,width:r.size,height:r.size,animation:"ripple 600ms ease-out"}},r.id)),s.jsx(ne,{size:20})]})})]})]})};export{be as C};

import{r as c,j as e}from"./index-BEcDo9m9.js";import{k as P,l as Q,e as V}from"./MessageContextMenu-Cnrkk1Eh.js";import{f as Z}from"./formatText-BvQYyoZd.js";const _=({content:d,sender:$,showAvatar:y=!0,avatarSrc:v,avatarBgColor:p="bg-gray-400",showUsername:C=!1,username:r,showTimestamp:x=!1,timestamp:o,className:w="",groupPosition:l,showReadStatus:h=!1,isRead:u=!1,disableTextCopy:M=!1,"aria-label":O,messageId:k,contextMenuItems:t})=>{const[Y,f]=c.useState(!1),[E,N]=c.useState({x:0,y:0}),[i,m]=c.useState(null),[b,g]=c.useState(null),s=$==="user",S=!l||l==="standalone"||l==="last",U=!l||l==="standalone"||l==="first",T=y&&S,X=C&&U,A=S,D=s?"bg-blue-500 text-white":"bg-gray-200 text-gray-900",z=A?s?"rounded-br-none":"rounded-bl-none":"",F=s?"justify-end":"justify-start",L=s?"flex-row-reverse":"flex-row",B=T&&e.jsx("div",{className:`shrink-0 w-10 h-10 rounded-full ${p} flex items-center justify-center text-white font-semibold overflow-hidden`,"aria-hidden":"true",children:v?e.jsx("img",{src:v,alt:r||(s?"User":"Other"),className:"w-full h-full object-cover"}):e.jsx("span",{children:(r||(s?"You":"Other")).charAt(0).toUpperCase()})}),W=l==="first"||l==="middle"?"mb-1":"mb-4",q=a=>{t&&t.length>0&&(a.preventDefault(),N({x:a.clientX,y:a.clientY}),f(!0))},G=a=>{if(!t||t.length===0)return;const n=a.touches[0];g({x:n.clientX,y:n.clientY});const j=setTimeout(()=>{N({x:n.clientX,y:n.clientY}),f(!0)},500);m(j)},H=a=>{if(!b||!i)return;const n=a.touches[0],j=Math.abs(n.clientX-b.x),K=Math.abs(n.clientY-b.y);(j>10||K>10)&&(clearTimeout(i),m(null),g(null))},J=()=>{i&&(clearTimeout(i),m(null)),g(null)};return e.jsxs(e.Fragment,{children:[e.jsx("article",{className:`flex ${F} ${W} ${w}`,"aria-label":O||`Message from ${s?"you":r||"other"}`,children:e.jsxs("div",{className:`flex ${L} items-end gap-2 max-w-[80%] md:max-w-[70%]`,children:[T?B:y&&e.jsx("div",{className:"shrink-0 w-10","aria-hidden":"true"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[X&&r&&e.jsx("div",{className:`text-xs text-gray-600 px-2 ${s?"text-right":"text-left"}`,"aria-label":"Sender name",children:r}),e.jsxs("div",{onContextMenu:q,onTouchStart:G,onTouchMove:H,onTouchEnd:J,className:`
                relative px-4 py-2 rounded-2xl shadow-sm
                ${D} 
                ${z}
                ${x||h?"pb-5":""}
                ${t&&t.length>0||M?"select-none":""}
              `,style:t&&t.length>0?{WebkitUserSelect:"none",touchAction:"manipulation"}:void 0,children:[e.jsx("div",{className:"text-sm md:text-base leading-relaxed break-words",children:typeof d=="string"?Z(d):d}),(x||h)&&e.jsxs("div",{className:`
                    absolute bottom-1 right-2 flex items-center gap-1
                  `,children:[x&&o&&e.jsx("time",{className:`text-xs ${s?"text-blue-100":"text-gray-500"}`,dateTime:o,"aria-label":`Sent at ${o}`,children:o}),h&&e.jsx("div",{className:"flex items-center","aria-label":u?"Read":"Sent",title:u?"Read":"Sent",children:u?e.jsx(P,{className:s?"text-blue-100":"text-gray-500",size:16}):e.jsx(Q,{className:s?"text-blue-100":"text-gray-500",size:16})})]})]})]})]})}),t&&t.length>0&&e.jsx(V,{isOpen:Y,position:E,items:t,onClose:()=>f(!1),messageId:k})]})};_.displayName="Message";export{_ as M};
